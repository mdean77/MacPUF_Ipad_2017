                                                                        SUBROUTINE DEADY(LL1,LL2,LL5,NREPT,SIMLT)C       THIS SR 1. TESTS FOR DEATH  2. PRINTS OUT VALUESC       3. REQUESTS AND CARRIES OUT USER ORDERSC       USES NXTWD IN ALL CASES FOR KEYBOARD INPUT        DIMENSION T(120),IANS(10)		CHARACTER ICHAR(5),ITRIG(72)        INTEGER I1, I2, I3, I4		COMMON KT,KL,INI,NW1,NW2,JKL,IFLAG,NEOF,NW        COMMON NFLAG,J3,ISPAR,NA,NB,NC,ND,NE(8)        COMMON NARTI,MT,K2,K4,INDEX        COMMON FIO2,FIC2,CO,PD,FADM,BULLA,VLUNG,ELAST,VADM,AZ,     /	BZ,CZ,BARPR,TEMP,TRQ,TC2MT,TVOL,HB,PCV,VBLVL,     /	ADDC3,BC3AJ,DPG,PR,FITNS,SPACE,COMAX,SHUNT,VC,PEEP,     /	VO2CT,PA,RPH,VPH,FVENT,BPH,BAGO,BAGC,AO2MT,AC2MT,     /	AO2PR,AC2PR,DPH,XLACT,BO2PR,BC2PR,TIDVL,RRATE,RO2CT,VC2MT,     /	DVENT,SVENT,PC2CT,PO2CT,TO2CT,TC2CT,BO2CT,BC2CT,TPH,RC3CT,     /	VC2CT,RO2MT,RC2MT,XRESP,AN2MT,BO2MT,BC2MT,CBF,PC,DSPAC,     /	REFLV,RO2PR,CONSO,RC2PR,PG,PJ,TND,RC2CT,QB,PW,     /	FT,CONOM,BUBBL,TC2RF,TC3MT,VC3MT,TC3CT,VC3CT,TLAMT,RLACT,     /	BC3CT,BO2AD,COADJ,EO2CT,TO2MT,TO2PR,TC2PR,VO2MT,AVENT,PL,     /	EC2CT,TN2MT,TN2PR,FEV,SN2PR,EN2CT,UN2MT,RN2MT,X109,X110,     /	TC3AJ,SN2MT,QA,RVADM,XDSPA,BAG,XMALE,HT,WT,AGE        COMMON /ANSWER/ ITRIG		EQUIVALENCE (FIO2,T(1))        DATA ICHAR /'1',' ','5',' ',' '/        IF (LL1-2) 360,380,300300     WRITE (*,301)301		FORMAT('..1.BACKTRACK 2.CONTINUE 3.RESTART 4.INSPECT 5.STOP')        NW2=0        CALL NXTWD(7,XX,NNN,1,6)        GO TO (330,600,600,500,1120,610), NNN330     NW=0        GOTO 920360     IFLAG=IFLAG+1        IF (NC-2)370,1110,1110370     IF (NB.EQ.1) GO TO 470        IF (MT.LT.1) GO TO 1110380     X=10.*2.**(ABS(8.-RPH)*3.33)        WRITE(*,70)         WRITE(*,71) RO2PR,RO2CT,PJ        WRITE(*,72) RC2PR,RC2CT        WRITE(*,73) RPH,X,RC3CT70      FORMAT(1X,'FINAL VALUES FOR THIS RUN WERE.......')71      FORMAT(1X,'ARTERIAL PO2 =',F6.1,', O2 CONT =',F6.1,', O2 SAT=     /	',F5.0)72      FORMAT(1X,'ARTERIAL PCO2=',F6.1,', CO2 CONT=',F6.1)73      FORMAT(1X,'ARTERIAL PH  =',F5.2,',(',F4.0,'NM), ART.      /	BICARBONATE=',F5.1,/)        WRITE(*,80) RRATE,TIDVL        WRITE(*,81) DVENT,COADJ        WRITE(*,82) DSPAC,PW80      FORMAT(1X,'RESPIRATORY RATE =',F5.1,', TIDAL VOL.=',F6.1,' ML')81      FORMAT(1X,'TOTAL VENTILATION=',F6.2,' L/MIN, ACTUAL CARD.OUTPUT     /=',F6.2,' L/MIN')82      FORMAT(1X,'TOTAL DEAD SPACE =',F5.1,' ML, ACTUAL VENOUS ADMIXTU     /=',F6.1,' PERCENT')        IF (LL1.EQ.2) GO TO 300C       IFLAG CONTROLS PRINTOUT OF FIRST 6 FACTORS AT END OF RUN        IF (IFLAG.GT.2) GO TO 1110        WRITE (*,90) T(1),T(2),T(3)        WRITE(*,91) T(4),T(5),T(6)90      FORMAT(' 1.INSP.O2=',F5.0,', 2.CO2=',F5.0,' PERCENT, 3.NOM.     /CARD.OUTP.=',F5.0,' PERCENT')91      FORMAT(' 4.TISS.METAB.=',F5.0,' , 5.VENOUS ADMXT.=',F5.0,     /', 6.D.SPACE+=',F6.0,' ML')        IF (IFLAG.EQ.2) WRITE (*,100)100     FORMAT(' (THE FACTOR LIST ABOVE WILL NOW DISAPPEAR REFER TO     /	HANDBOOK)')        GO TO 1110430     NW=0        CALL CLIN1(SIMLT)        IF (NB.EQ.2) RETURN        GO TO 470440     IF (NW.GT.0) GO TO 430        NB=1        KYY=69-NW1        DO 450, I=1,KYY		I1=73-I		I2=69-I450     ITRIG(I1)=ITRIG(I2)        DO 460, I=1,4		I3=NW1+I-1460     ITRIG(I3)=ICHAR(I)		I4=NW1+3        IF(NW2.LE.19) ITRIG(I4)=ICHAR(5)        NW2=20        GO TO 600470     IF (NW2.GT.19) GO TO 490        WRITE(*,480)480     FORMAT(' DO YOU WANT TO..1.CHANGE, 2.CONTINUE, 3.RESTART,     /	4.INSPECT, 5.STOP')        NW2=0490     CALL NXTWD(15,XXX,NNN,1,6)        JKL=0        GO TO (640,630,600,500,1120,610),NNN500     X=T(22)+T(91)        Y=T(16)*1000.        WRITE(*,200)200     FORMAT(14X,'P.PRESSURES     CONTENTS CC%   AMOUNTS IN CC  PH     /  HCO3-')        WRITE(*,201)201     FORMAT(9X,3(6X,'O2',5X,'CO2'),/)        WRITE(*,202) T(72),T(74),T(49),T(78),T(62),T(63),T(33),T(60)202     FORMAT(' ARTERIAL ',4F8.1,2F8.0,F7.3,F6.1)        WRITE(*,203) T(41),T(42),T(76),T(39),T(40)203     FORMAT(' ALV./LUNG',2F8.1,' (SAT=',F4.0,')',5X,2F8.0)        WRITE(*,204)T(41),T(42),T(54),T(53)204     FORMAT(' (PULM.CAP)',F7.1,3F8.1)        WRITE(*,205)  T(45),T(46),T(57),T(58),T(66),T(67),T(36),X205     FORMAT(' BRAIN/CSF',4F8.1,2F8.0,F7.3,F6.1)        WRITE(*,206) T(96),T(97),T(55),T(56),T(95),Y,T(59)206     FORMAT(' TISSUE/ECF',F7.1,3F8.1,2F8.0,F7.3)        WRITE(*,207) T(96),T(97),T(31),T(61),T(98),T(50),T(34),T(88)207     FORMAT(' MIXED VEN. (',F5.1,F8.1,')',F7.1,F8.1,2F8.0,F7.3,F6.1)        IF (PL.GE.1.) CALL BAGER (7,X,Y,PPH,SIMLT)210     WRITE(*,220) RLACT220     FORMAT(' PLASMA LACTATE CONC.=',F4.1,' MMOL/L',/)        IF (LL1.EQ.2.OR.LL5.LT.0) GO TO 300        RR=DSPAC/(TIDVL+.000001)        X=QA/FT        Y=QB/FT        WRITE(*,530) X,Y,PC530     FORMAT(' 02 UPTAKE= ',F6.1,' CO2 OUTPUT= ',F6.1,' CC/MIN(STPD)     / EXPIRED R.Q.=',F5.2)        WRITE(*,540) DVENT,FVENT,RRATE,PW540     FORMAT(' TOT.VENT.=',F5.2,'  ALV.VENT(BTPS)=',F4.2,     /	'  R.RATE=',F4.1,'  VEN.ADMX.=',F4.1,' ')        IF (DVENT.GE..2) WRITE(*,550) DSPAC,TIDVL,RR550     FORMAT(' DEAD SPACE(BTPS)=',F5.1,'  TIDAL VOL.=',F5.1,     /	'  D.SP./TID.VL.RATIO=',F5.2)560     IF (COADJ.GT..1) WRITE(*,570) COADJ,CBF570     FORMAT(' CARDIAC OUTPUT=',F5.2,'  CEREBRAL BLOOD FLOW='     /	,F5.1,' ML/100G/MIN')        IF (BUBBL.GT.0) WRITE(*,580) BUBBL580     FORMAT(' NITROGEN SUPERSATURATION INDEX = ',F6.0)        IF(PL.LT.0.) CALL BAGER(6,X,Y,PPH,SIMLT)        WRITE(*,590)590     FORMAT(/)        IF (LL1-2) 470,300,300600     LL1=3        MT=0        RETURNC+++    NEW FORMAT610     WRITE(*,620) T620     FORMAT(1X,10F7.2)        IF (LL1-2) 470,300,300630     IF (NB.EQ.1) NB=0        NREPT=NA        RETURN640     IF (NW2.GT.19) GO TO 660        WRITE(*,650)650     FORMAT(' 1.CHANGE VALUES, 2.NA/ART VENT, 3.STORE/BKTRK,     / 	4.RUN CHANGE, 5.PRESETS')        NW2=0660     CALL NXTWD(3,XXX,NNN,1,5)        IF (NNN.NE.5) NW=0        GO TO (930,820,920,670,440), NNN670     IF (NW2.GT.19) GO TO 690        WRITE(*,680) 680     FORMAT(' TYPE NO. SECONDS FOR RUN (1800 MAX)')690     CALL NXTWD(7,XT,NNN,2,1800)        IF (NW2.GT.19) GOTO 710        WRITE(*,700)700     FORMAT(' TYPE ITERATION INTERVAL IN SECONDS (10 MAX)')710     CALL NXTWD(12,XXX,NNN,0,10)        FT=XXX/60.+.000001        NA=INT(XT/XXX)        IF (NW2.GT.19) GO TO 730        WRITE (*,720)720     FORMAT(' DO YOU WANT 1.ALL, 2.EVERY 6TH, OR 3.EVERY 30TH     /VALUE PRINTED?')730     CALL NXTWD(11,XXX,ISPAR,1,3)        IF (NW2.GT.19) GO TO 750        WRITE(*,740)C       THIS ALLOWS STRING OF 1 TO 8 NUMBERS TO BE FED INTO ARRAYC       WHICH IS USED FOR SELECTED COLUMNS OUTPUT740     FORMAT(' DO YOU WANT..1.GRAPHS + TEXT, 2.GRAPHS ONLY, 3.SELECT     / VALUES')750     CALL NXTWD(5,XXX,NC,1,4)        MT=1        GO TO (470,810,760,470), NC760     IF (NW2.GT.19) GO TO 780        WRITE (*,770)770     FORMAT(' TYPE UP TO 8 NOS. - 69 GIVES STANDARD ARRAY ')        NW2=0780     NEOF=8        NL=0        JKL=1790     CALL NXTWD(6,XXX,NNN,1,120)        NW2=NW2+1        NL=NL+1        IF(JKL.EQ.0) GO TO 800        IF (NEOF.EQ.0) GO TO 470        NE(NL)=NNN        GO TO 790800     NE(NL)=NNN810     MT=0        GO TO 470820     IF (NW2.GT.19) GO TO 840        WRITE(*,830)830     FORMAT(' 1.GIVE ARTIFICIAL, 2. RETURN TO NATURAL VENTILATION')840     CALL NXTWD(7,XXX,NARTI,1,2)        NARTI=NARTI-1        IF (NARTI) 850,850,841841     PEEP=0.        WRITE(*,842)842     FORMAT(' *** NATURAL VENTILATION ***')        GO TO 470850     IF (NW2.GT.19) GOTO 870        WRITE(*,860)860     FORMAT(' GIVE VENTILATOR RATE IN CYCLES PER MINUTE')870     CALL NXTWD(7,RRATE,NNN,0,200)        IF (RRATE.LE..001) RRATE=.001        IF (NW2.GT.19) GO TO 890        WRITE(*,880)880     FORMAT(' NOW ENTER TIDAL VOLUME IN ML')890     CALL NXTWD(8,TIDVL,NNN,0,5000)        IF (TIDVL.LE..001) TIDVL=.001        NW=0        IF(NW2.GT.19) GO TO 910        WRITE(*,900)900     FORMAT(' PEEP - ENTER ''0'' OR NUMBER OF CM H20 (MAX 15)')910     CALL NXTWD(16,PEEP,NNN,0,15)        WRITE(*,912) RRATE,TIDVL,PEEP912     FORMAT(' VENTILATOR AT',F4.0,'/MIN,'F6.0,'ML TIDAL VOLUME, AND     /',F4.0,'CM PEEP')        GOTO 470920     CALL DUMP(LL1)        NB=0        GOTO 470930     IF (NW2.GT.19) GOTO 950        WRITE(*,940)940     FORMAT(' TYPE NO. OF FACTOR (1-30) TO CHANGE, OR 100 FOR     /BAG EXPMTS.,ETC.')        NW2=0950     NEOF=10        NL=0        KYY=-1        JKL=1960     CALL NXTWD(9,XXX,NNN,1,120)        IF(NNN.EQ.100) GO TO1100        KYY=KYY+1        NW2=NW2+1        NL=NL+1        IF(JKL.EQ.0) GO TO 980        IF(NEOF.EQ.0) GO TO 990        IANS(NL)=NNN        IF (NNN.GT.30) WRITE(*,970) NNN970     FORMAT(' POINTLESS - FACTOR ',I4,' WILL BE CHANGED BACK AGAIN     / DURING THE SIMULATION RUN.')        GO TO 960980     IANS(NL)=NNN        KYY=KYY+1990     IF (NW2.GT.19) GO TO1000        NW2=01000    DO1040, IJ=1,KYY        I=IANS(IJ)        IF(NW2.GT.19) GO TO 1020        WRITE(*,1010) I,T(I)1010    FORMAT(1X,'FACTOR ',I3,' (CURRENT VALUE=',F7.2,'),     / SPECIFY NEW VALUE')1020    CALL NXTWD(10,XXX,NNN,-500,16000)        WRITE(*,1030) I,XXX,T(I)1030    FORMAT(1X,'FACTOR ',I3,' =',F7.2, '(PREVIOUSLY =     /',F7.2,')')        T(I)=XXX        IF(T(I).EQ.0.) T(I)=.000000011040    CONTINUE1050    NW=0        REFLV=VLUNG        GOTO 4701100    CALL BAGER(1,X,Y,PPH,SIMLT)        GO TO 1050C       CHECK FOR SYMPTOMS1110    IF (NB.EQ.2) CALL DUMP(LL1)        CALL SYMPT(SIMLT)        GOTO 4701120    WRITE(*,1130)1130    FORMAT(' THANK YOU FOR YOUR INTEREST.')        STOP' COME BACK AGAIN'        END