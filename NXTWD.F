		SUBROUTINE NXTWD(LL3,XXX,NNN,IMIN,IMAX)C       THIS SUBROUTINE AND THE FUNCTIONS V1 AND VALUE PERMIT NUMBERSC       TO BE ENTERED FREE FORM AND CAN ALSO ALLOW STRINGS OF COMMANDS		DIMENSION ITEM(20)        CHARACTER ICHAR(18), ITRIG(72)		COMMON KT,KL,INI,NW1,NW2,JKL,IFLAG,NEOF,NW		COMMON /ANSWER/ ITRIG        DATA ICHAR /' ','1','2','3','4','5','6','7','8','9','0',     /'.','-','/','B','F','U','Q'/        XMIN=IMIN        XMAX=IMAX10      DO 20 J=1,20        ITEM(J)=120      CONTINUE        IF (NW2.GE.1) GOTO 110        NREF=NEOF        DO 30, J=1,7230      ITRIG(J)='0'        IL=1        WRITE (*,40)40      FORMAT (1X,'?')        READ (*,50) (ITRIG(IM),IM=1,72)50      FORMAT(72A1)60      IF (ITRIG(1).NE.ICHAR(1).AND.ITRIG(1).NE.ICHAR(14)) GOTO 100        IF (LL3.EQ.10) GOTO 29070      WRITE(*,80)80      FORMAT(' A number must be entered.')        GOTO 15090      CALL QUERY (LL3)        GOTO 150100     IF (ITRIG(IL).EQ.ICHAR(18)) GOTO 90        NW1=IL110     L=0        DO 190 IL=NW1,72        DO 120 J=1,14        IF (ITRIG(IL).EQ.ICHAR(J)) GOTO 170120     CONTINUE        IF((ITRIG(IL).EQ.ICHAR(15).OR.ITRIG(IL).EQ.ICHAR(16)).AND.     /ITRIG(IL+1).EQ.ICHAR(17)) WRITE (*,121)121		FORMAT(' DON''T USE RUDE WORDS')130     WRITE (*,131)131		FORMAT(' Only numbers are acceptable.')150     WRITE (*,151)151		FORMAT(' Please try again.')		NW2=0        NEOF=NREF        GOTO 10170     IF (J.NE.1.AND.J.NE.14) GOTO 180        IF (L) 190,190,200180     L=L+1        IF (L.EQ.20) GOTO 270        ITEM(L)=J        IF (J.EQ.1) GOTO 200190     CONTINUE        IL=72        IF (NW2.GT.19) GOTO 70200     NW1=IL+1C       DETECT SLASH DELIMITER        IF (J.EQ.14) GOTO 240        IF (J.EQ.1.AND.NEOF.LE.1) NW2=0		IF (NW1 .GE. 72) GOTO 230        IF (J.EQ.1.AND.ITRIG(NW1).EQ.ICHAR(1).AND.NW2.GT.19) GOTO 310210     IF (NW1.GE.72) GOTO 230        XXX=VALUE(ITEM)        NNN=INT(XXX)        IF(NNN.EQ.-999) GOTO 220        IF (((XXX-XMIN)*(XMAX-XXX)).LT.0) GOTO 270220     NEOF=NEOF-1        RETURN230     NEOF=1        NW2=0        GOTO 220240     NW2=20        JKL=0        NEOF=1        GOTO 210270     WRITE (*,280) IMIN,IMAX280     FORMAT('It has to be between ',I7,' and ',I6)        GOTO 150290     ITEM(1)=13        DO 300 J=2,4300     ITEM(J)=10        NW1=1310     JKL=0        NW2=0        GOTO 210        END