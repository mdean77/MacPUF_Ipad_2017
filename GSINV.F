        SUBROUTINE GSINV(PO2,PC2,O2CON,C2CON,PH,SAT)C       THIS SUBROUTINE USES REITERATIVE APPROXIMATION TO CONVERTC       FROM O2 AND CO2 CONTENTS TO GAS PARTIAL TENSIONS.        COMMON NTAB(29)        COMMON Y1(13),TEMP,Y2(3),HB,PCV,Y3(23),DPH,Y4(40),PK        DATA ERR,FACT/.01,1./        D1Z=2.        D2Z=2.        ICH1=1        ICH2=1        ICH3=1C       WRITE(*,5) PO2,PC2,O2CON,C2CON,SAT,PH5       FORMAT(' PO2 PC2 O2CON C2CON SAT PH ARE ',/     /1X,6(F6.2))        ICH4=1C	ICH1, ICH2, ICH3, ICH4 are all set to one to indicate that the values are notC	yet adequately approximated AND a bracket procedure is in effect for both pO2 and pCO2C10      CALL GASES(PO2,PC2,X,Y,PH,SAT)C       WRITE(*,5) PO2,PC2,O2CON,C2CON,SAT,PHC	So we call GASES with the current value of pO2 and pCO2, and get contentsC	Then we compare those saturations to the presently known contents from the simulatorC	We need the difference to be at least 0.001 so that we don't get arithmetic errors        XX2=X-O2CON        YY2=Y-C2CON        IF(XX2) 30,20,3020      XX2=.00130      IF(YY2) 50,40,5040      YY2=.001C	We have now checked to make sure the difference is 0.001 or greater50      XP2=PO2        YP2=PC2        IF (ICH3-1) 70,60,70C	ICH3 is a flag that indicates a bracket is being pursued for pO2C	ICH1 is a flag that indicates if pO2 is adequately approximated (ICH1 = 0)C	ICH4 is a flag that indicates a bracket is being pursued for pCO2C	ICH2 is a flag that indicates if pCO2 is adequately approximated (ICH2 = 0)C60      ICH3=0        D1=SIGN(D1Z,-XX2)70      IF (ICH4-1) 120,80,12080      ICH4=0        D2=SIGN(D2Z,-YY2)        IF (ABS(XX2)-ERR) 90,90,10090      ICH1=0100     IF(ABS(YY2)-ERR) 110,110,120110     ICH2=0        IF (ICH1+ICH2) 360,360,120120     DS=D1*ICH1        X=PO2+DS-PO2*.25        IF(X) 130,140,140130     DS=-PO2*.75140     PO2=PO2+DS        DS=D2*ICH2        X=PC2+DS-PC2*.25        IF(X) 150,160,160150     DS=-PC2*.75160     PC2=PC2+DS        IF(PO2-.1) 170,180,180170     PO2=.1180     IF (PC2-.1) 190,200,200190     PC2=.1200     CALL GASES (PO2,PC2,X,Y,PH,SAT)C       WRITE(*,5) PO2,PC2,O2CON,C2CON,PH,SAT        XX1=XX2        YY1=YY2        XX2=X-O2CON        XP1=XP2        XP2=PO2        YY2=Y-C2CON        YP1=YP2        YP2=PC2        IF(ABS(XX2)-ERR) 210,210,220210     ICH1=0        GO TO 270220     ICH1=1        IF (XX2*D1) 230,270,260230     IF (XP2-XP1) 250,240,250240     D1=SIGN(D1Z,-XX2)        GO TO 270250     D1=(XP2-XP1)*ABS(XX2)/(FACT*ABS(XX2-XX1))        GO TO 270260     ICH3=1        PO2=XP1+(XP2-XP1)*ABS(XX1)/(ABS(XX2)+ABS(XX1))        D1Z=D1Z/2.270     IF(ABS(YY2)-ERR) 280,280,290280     ICH2=0        GO TO 340290     ICH2=1        IF(YY2*D2) 300,340,330300     IF(YP2-YP1) 320,310,320310     D2=SIGN(D2Z,-YY2)        GO TO340320     D2=(YP2-YP1)*ABS(YY2)/(FACT*ABS(YY2-YY1))        GO TO 340330     ICH4=1        PC2=YP1+(YP2-YP1)*ABS(YY1)/(ABS(YY1)+ABS(YY2))        D2Z=D2Z/2.340     IF (ICH1+ICH2) 360,360,350350     IF (ICH3+ICH4-1) 120,10,10360     RETURN        END